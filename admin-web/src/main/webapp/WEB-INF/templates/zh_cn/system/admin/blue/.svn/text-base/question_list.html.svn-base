<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
</head>
<link href="$!webPath/resources/style/system/manage/$!{config.websiteCss}/template.css"  rel="stylesheet" type="text/css"/>
<link  href="$!webPath/resources/style/common/css/jquery-ui-1.8.22.custom.css" type="text/css" rel="stylesheet" />
<script src="$!webPath/resources/js/jquery-1.6.2.js"></script>
<script src="$!webPath/resources/js/jquery.shop.common.js"></script>
<script src="$!webPath/resources/js/jquery.poshytip.min.js"></script>
<script src="$!webPath/resources/js/jquery.validate.min.js"></script>
<script src="$!webPath/resources/js/jquery.shop.common.js"></script>
<script src="$!webPath/resources/js/jquery.poshytip.min.js"></script>
<script src="$!webPath/resources/js/jquery-ui-1.8.21.js"></script>
<script src="$!webPath/resources/js/jquery.imgareaselect.js"></script>
<script src="$!webPath/resources/js/jquery.zh.cn.js" charset="utf-8"></script>
<script src="$!webPath/resources/js//jquery.metadata.js" type="text/javascript"></script>
<script>
jQuery(document).ready(function(){
	 jQuery("#ListForm").validate();

});
function saveIndex() {
	if(confirm('确定更新排序?')){
		 var r = jQuery("#ListForm").valid(); 
		 var ary = new Array();
		 $(".opdata").each(
		          function() {
		        	  ary.push($(this).val());
		          }
		    );
		 var hash = {};
		 for(var i in ary) {
		     if(hash[ary[i]])
		        {
			        alert('排序值【' + ary[i] + '】重复，请保证排序值不重复!');
		            return false;
		        }
		     	hash[ary[i]] = true;
		    }
		  $(".opdata").each(
		          function() {
		        	  $("#" + $(this).attr("name") + "").val($(this).val());
		          }
		    );
		  jQuery("#ListForm").attr("action","$!webPath/admin/question_index_update.htm");
		  jQuery("#ListForm").submit();
	}
}
</script>
<body>
<div class="cont">
  <h3 class="seth">自测套题管理</h3>
  <div class="nav_list">
    <ul>
      <li><a href="$!webPath/admin/question_list.htm?groupId=$!groupId" class="this"><b>题目列表</b></a></li>
      <li><a href="$!webPath/admin/question_add.htm?groupId=$!groupId"><b>新增题目</b></a></li>
    </ul>
  </div>
  <form action="$!webPath/admin/question_list.htm" id="ListForm" name="ListForm" method="post">
  	<input id="listUrl" name="listUrl" type="hidden" value="$!webPath/admin/question_list.htm?groupId=$!groupId&currentPage=$!currentPage"/>
  	<input id="addUrl" name="addUrl" type="hidden" value="$!webPath/admin/question_add.htm?groupId=$!groupId&currentPage=$!currentPage"/>
  	<input id="groupId" name="groupId" value="$!groupId" type="hidden"/>
  	
    <div class="fshoptb">
      <table width="100%" border="0" cellspacing="0" cellpadding="0" class="fshop_table">
        <tr>
          <th width="4%">&nbsp;</th>
           <th width="30%"><span class="form_btna">排序</span></th>
          <th width="50%"><span class="form_btna">题目</span></th>
          <th><b class="form_btnb">操作</span></th>
        </tr>
        #foreach($obj in $list)
        <tr>
          <td class="check_position">
          	<input name="checkbox" type="checkbox" id="checkbox" value="$!obj.id" />
          	<input name="id"  value="$!obj.id" type="hidden"/>
          </td>
          <td align="center">
          	#set($optionIndexName="$!obj.id" + "questionIndex")
          	<input  type="text" name="$!optionIndexName" value="$!obj.questionIndex" 
          		class="{required:true,digits:true,max:999,messages: { required: '题目排序必填',digits:'题目排序必须为正整数',max:'题目排序不能超过999'}}  opdata" />
          	<input name="questionIndex"  id="$!optionIndexName" type="hidden" value="$!obj.questionIndex"/>
          </td>
          <td align="center">$!obj.questionTitle</td>
          <td class="hui oprate_con" align="center"><a href="$!webPath/admin/question_edit.htm?id=$!obj.id&groupId=$!groupId" class="blue">编辑</a>
          |<a href="javascript:void(0);" onclick="if(confirm('删除后不可恢复，是否继续?'))window.location.href='$!webPath/admin/question_delete.htm?groupId=$!groupId&mulitId=$!obj.id&currentPage=$!currentPage'" class="blue">删除</a></td>
        </tr>
        #end
      </table>
    </div>
    <div class="operate_bar">
      <div class="fenye">
        <input type="hidden" name="currentPage" id="currentPage" value="$!currentPage" />
<!--          <input type="hidden" name="circleId" id="circleId" value="$!vo.circleId" /> -->
        <input name="mulitId" type="hidden" id="mulitId" />
         </div>
      <div class="oper_sp"> <span class="oper_check">
      <label>
        <input type="checkbox" name="all" id="all" onclick="selectAll(this)" value="" />
        全部
       </label> </span> <span class="oper_del">
        <input name="" type="button" value="删除" style="cursor:pointer;" onclick="cmd('$!webPath/admin/question_delete.htm')"/>
        &nbsp;&nbsp;&nbsp;<input name="" type="button" value="保存排序" style="cursor:pointer;" onclick="saveIndex();"/>
        </span> </div>
    </div>
  </FORM>
</div>
</body>
</html>
